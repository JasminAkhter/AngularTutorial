<section class="py-5" style="background: #f9fafb;">
  <div class="container">
    <div class="row g-4">

      <!-- Customer Form -->
      <div class="col-12 col-lg-5 mb-3">
        <div class="card shadow-sm border-0 rounded-3">
          <div class="card-header text-center" style="background: #0e3547;">
            <h4 class="mb-0 text-white fw-bold">Customer Form</h4>
          </div>
          <div class="card-body py-5 me-2">
            <form #customerForm="ngForm" (ngSubmit)="saveCustomer(customerForm)">
              <div class="row mb-3 align-items-center">
                <div class="col-sm-8">
                  <input type="hidden" id="id" name="id" [(ngModel)]="customerData.id">
                </div>
              </div>

              <div class="row mb-3 align-items-center">
                <label for="customerName" class="col-sm-4 col-form-label fw-semibold text-end">Full Name :
                  <span class="text-danger">*</span></label>
                <div class="col-sm-8">
                  <input type="text" id="customerName" name="customerName" class="form-control shadow-sm"
                    placeholder="Enter full name" required [(ngModel)]="customerData.name" #name="ngModel"
                    [ngClass]="{'is-invalid': customerForm.submitted && name.invalid}">
                  <div *ngIf="customerForm.submitted && name.invalid" class="text-danger small mt-1">
                    Full name is required.
                  </div>
                </div>
              </div>

              <div class="row mb-3 align-items-center">
                <label for="email" class="col-sm-4 col-form-label fw-semibold text-end">
                  Email :<span class="text-danger">*</span>
                </label>
                <div class="col-sm-8">
                  <input type="email" id="email" name="email" class="form-control shadow-sm" placeholder="Enter email"
                    required email [(ngModel)]="customerData.email" #emailField="ngModel"
                    [ngClass]="{'is-invalid': customerForm.submitted && emailField.invalid}">
                  <div *ngIf="customerForm.submitted && emailField.invalid" class="text-danger small mt-1">
                    Valid email is required.
                  </div>
                </div>
              </div>

              <div class="row mb-3 align-items-center">
                <label for="phone" class="col-sm-4 col-form-label fw-semibold text-end">Phone :</label>
                <div class="col-sm-8">
                  <input type="tel" id="phone" name="phone" class="form-control shadow-sm"
                    placeholder="Enter phone number" [(ngModel)]="customerData.phone">
                </div>
              </div>

              <div class="row mb-3 align-items-center">
                <label class="col-sm-4 col-form-label fw-semibold text-end">Gender :</label>
                <div class="col-sm-8">
                  <div class="form-check form-check-inline">
                    <input type="radio" class="form-check-input" name="gender" value="Male"
                      [(ngModel)]="customerData.gender">
                    <label class="form-check-label">Male</label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input type="radio" class="form-check-input" name="gender" value="Female"
                      [(ngModel)]="customerData.gender">
                    <label class="form-check-label">Female</label>
                  </div>
                </div>
              </div>

              <div class="row mb-4 align-items-center">
                <label for="address" class="col-sm-4 col-form-label fw-semibold text-end">Address :</label>
                <div class="col-sm-8">
                  <textarea id="address" name="address" class="form-control shadow-sm" rows="3"
                    placeholder="Enter address" [(ngModel)]="customerData.address"></textarea>
                </div>
              </div>

              <div class="row">
                <div class="col-12 text-center">
                  <button type="submit" class="btn text-white py-2 px-5 fw-semibold"
                    style="background: #0a283f; box-shadow: 0 4px 8px rgba(131, 88, 88, 0.05);">
                    <span>{{ isEditMode ? 'Update' : 'Save' }}</span>
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Customer Data Table -->
      <div class="col-12 col-lg-7 mb-3">
        <div class="card shadow-sm border-0 rounded-3 h-100 d-flex flex-column">
          <div class="card-header text-center py-2" style="background: #0e3547;">
            <h4 class="mb-0 text-white fw-bold">Customer Data</h4>
          </div>

          <div class="card-body p-0 flex-grow-1 d-flex flex-column">
            <!-- Search Input -->
            <div class="p-3">
              <mat-form-field class="w-100">
                <mat-label>Search</mat-label>
                <input matInput (keyup)="search($event)" placeholder="Search customers...">
              </mat-form-field>
            </div>

            <!-- Loading Spinner -->
            <div *ngIf="isLoading" class="text-center p-4 flex-grow-1 d-flex align-items-center justify-content-center">
            </div>

            <!-- Table and paginator container -->
            <div class="table-responsive my-table-wrapper flex-grow-1" style="overflow-y: auto;">
              <table mat-table [dataSource]="dataSource" class="mat-elevation-z1" style="min-width: 100%;">
                <!-- Columns as before -->
                <ng-container matColumnDef="id">
                  <th mat-header-cell *matHeaderCellDef> ID </th>
                  <td mat-cell *matCellDef="let customer; let i = index">
                    {{(pageIndex * pageSize) + i + 1}}
                  </td>
                </ng-container>

                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef> Name </th>
                  <td mat-cell *matCellDef="let customer"> {{customer.name}} </td>
                </ng-container>

                <ng-container matColumnDef="email">
                  <th mat-header-cell *matHeaderCellDef> Email </th>
                  <td mat-cell *matCellDef="let customer"> {{customer.email}} </td>
                </ng-container>

                <ng-container matColumnDef="phone">
                  <th mat-header-cell *matHeaderCellDef> Phone </th>
                  <td mat-cell *matCellDef="let customer"> {{customer.phone}} </td>
                </ng-container>

                <ng-container matColumnDef="gender">
                  <th mat-header-cell *matHeaderCellDef> Gender </th>
                  <td mat-cell *matCellDef="let customer"> {{customer.gender}} </td>
                </ng-container>

                <ng-container matColumnDef="address">
                  <th mat-header-cell *matHeaderCellDef> Address </th>
                  <td mat-cell *matCellDef="let customer"> {{customer.address}} </td>
                </ng-container>

                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef> Actions </th>
                  <td mat-cell *matCellDef="let customer">
                    <button class="btn btn-info btn-sm me-2" (click)="editCustomer(customer)" title="Edit" 
                    style="background-color:#46f3f3fa; color:white; border:none;">
                      <i class="bi bi-pencil-square"></i>
                    </button>
                    <button class="btn btn-sm btn-danger" (click)="deleteCustomer(customer.id)" title="Delete" 
                    style="background-color:#eb4909; color:white; border:none;">
                      <i class="bi bi-trash"></i>
                    </button>
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell text-center py-4" colspan="7">
                    No data matching the filter
                  </td>
                </tr>
              </table>
            </div>

            <!-- Paginator -->
            <div style="overflow: visible;" class="p-3">
              <mat-paginator [length]="totalRecords" [pageSize]="pageSize" [pageIndex]="pageIndex"
                [pageSizeOptions]="[5,10,25,100]" (page)="onPageChange($event)" showFirstLastButtons>
              </mat-paginator>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>
